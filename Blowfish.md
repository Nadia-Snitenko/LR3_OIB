# Blowfish
Blowfish — криптографический алгоритм, реализующий блочное симметричное шифрование.
Разработан Брюсом Шнайером в 1993 году. Представляет собой сеть Фейстеля. 
Выполнен на простых и быстрых операциях: XOR, подстановка, сложение. Является не запатентованным и свободно распространяемым.
Blowfish зарекомендовал себя как надёжный алгоритм, поэтому реализован во многих программах, где не требуется частая смена ключа и необходима высокая скорость шифрования/расшифровывания.
### История
До появления Blowfish существовавшие алгоритмы были либо запатентованными, либо ненадежными, а некоторые и вовсе держались в секрете(Skipjack). 
Алгоритм был разработан в 1993 году Брюсом Шнайером в качестве быстрой и свободной альтернативы устаревшему DES и запатентованному IDEA. 
По заявлению автора, критерии проектирования Blowfish были:\
•	скорость(шифрование на 32-битных процессорах происходит за 26 тактов) ;\
•	простота(за счет использования простых операций, уменьшающих вероятность ошибки реализации алгоритма);\
•	компактность;\
•	настраиваемая стойкость.
### Применение:
•	хеширование паролей\
•	защита электронной почты и файлов\
•	GnuPG (безопасное хранение и передача)\
•	в линиях связи: связка ElGamal (не запатентован) или RSA (действие патента закончилось в 2000 году) и Blowfish вместо IDEA\
•	в маршрутизаторе Intel Express 8100 с ключом длиной 144 бита\
•	обеспечение безопасности в протоколах сетевого и транспортного уровня\
•	SSH (транспортный уровень)\
•	OpenVPN (создание зашифрованных каналов)
### Алгоритм Blowfish 
Разделен на 2 этапа:
1.	Подготовительный — формирование ключей шифрования по секретному ключу.\
•	Инициализация массивов P и S при помощи секретного ключа K.
Инициализация P1-P18 фиксированной строкой, состоящей из шестнадцатеричных цифр числа пи, следующих после 3, то есть после запятой. Производится операция XOR над P1 с первыми 32 битами ключа K, над P2 со вторыми 32-битами и так далее.
Если ключ K короче, то он накладывается циклически.\
•	Шифрование ключей и таблиц замен
Алгоритм шифрования 64-битного блока, используя инициализированные ключи P1-P18 и таблицу замен S1-S4 ,шифрует 64 битную строку, состоящую из 0(необязательно из 0, важно чтобы она была фиксированной).Результат записывается в P1,P2.
P1 и P2 шифруются измененными значениями ключей и таблиц замен. Результат записывается в P3 и P4. Шифрование продолжается до изменения всех ключей и таблицы замен.
2.	Шифрование текста полученными ключами и F(x), с предварительным разбиением на блоки по 64 бита.\
Если невозможно разбить начальный текст точно на блоки по 64 бита, используются различные режимы шифрования для построения сообщения, состоящего из целого числа блоков. Cуммарная требуемая память 4168 байт: P1-P18:18 переменных по 32 бита; S1-S4: 4x256 переменных по 32 бита.
Выбор начального значения P-массива и таблицы замен.
Нет ничего особенного в цифрах числа пи. Данный выбор заключается в инициализации последовательности, не связанной с алгоритмом, которая могла бы быть сохранена как часть алгоритма или получена при необходимости(Пи (число)). Как указывает Шнайер :"Подойдет любая строка из случайных битов цифр числа e, RAND-таблицы, или случайные сгенерированные цифры."
